{
  "rules": {
    "categories": {
      ".read": "auth != null",

      "$categoryName": {
        ".write": "auth != null",

        "ownerKey": {
          ".validate": "(newData.val() === data.val()) || (newData.val() === auth.uid && !data.exists())"
        },

        "createdAt": {
          ".validate": "(newData.val() === data.val()) || (newData.isNumber() && !data.exists())"
        },

        "items": {
          "$itemKey": {
            "name": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "ownerKey": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "ownerName": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "categoryName": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "createdAt": {
              ".validate": "newData.isNumber() && newData.val() > 0"
            },
            "price": {
              ".validate": "newData.isNumber() && newData.val() >= 0"
            },
            "isFree": {
              ".validate": "newData.isBoolean()"
            },
            "$other": {
              ".validate": true
            }
          }
        }
      }
    },

    "transactions": {
      ".read": "auth != null",
      ".write": "auth != null",

      "$transactionKey": {
        "itemId": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "itemName": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "categoryName": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "sender": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "senderDisplayName": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "recipient": {
          ".validate": "newData.isString() && newData.val() == auth.uid"
        },
        "recipientDisplayName": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "status": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "amount": {
          ".validate": "newData.isNumber() && newData.val() >= 0"
        },
        "timestamp": {
          ".validate": "newData.isNumber() && newData.val() > 0"
        },
        "item": {
          "name": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "ownerKey": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "ownerName": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "categoryName": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "createdAt": {
            ".validate": "newData.isNumber() && newData.val() > 0"
          },
          "price": {
            ".validate": "newData.isNumber() && newData.val() >= 0"
          },
          "isFree": {
            ".validate": "newData.isBoolean()"
          },
          "$other": {
            ".validate": true
          }
        },
        "$other": {
          ".validate": true
        }
      }
    }
  }
}
